# Taskiq: Асинхронный менеджер распределённых задач

**Taskiq** — это современный асинхронный менеджер задач, который помогает организовать выполнение фоновых задач в
распределённой системе. Он работает с использованием паттернов, схожих с Celery, но является более гибким и современным
решением для приложений, использующих **asyncio**.

## Основные преимущества Taskiq

- **Готовность к продакшну**: Taskiq уже используется в высоконагруженных продакшн-системах и доказал свою надёжность.

- **Полностью асинхронный**: Taskiq поддерживает как асинхронные, так и синхронные функции. Вам не нужно беспокоиться о
  различиях, так как Taskiq работает с любыми функциями, которые вы ему передадите.

- **Лёгкая расширяемость**: Taskiq имеет множество заменяемых компонентов, таких как брокеры и промежуточные слои (middleware).
  Если стандартные компоненты вас не устраивают, вы можете легко реализовать свои собственные.

- **Строгая типизация**: Taskiq предлагает автодополнение и строгую типизацию для большинства функций, что делает разработку
  проще и безопаснее.

## Taskiq вкратце

Taskiq можно рассматривать как современную асинхронную версию Celery. Он использует похожие паттерны для управления задачами,
но предлагает более гибкую и расширяемую экосистему библиотек. Важно отметить, что Taskiq **не является прямым заменителем**
для других менеджеров задач и имеет свою уникальную экосистему с особенностями, которые отличаются от других решений.

Taskiq **не работает** для полностью синхронных проектов, и отправка задач синхронно невозможна. Это решение ориентировано на
асинхронные проекты.

## Как работает Taskiq?

В Taskiq основная работа происходит через "брокеры" — компоненты, которые управляют постановкой задач в очередь, их выполнением
и хранением результатов. В примере вашего кода используется **Redis** в качестве брокера, который хранит задачи в очереди и
позволяет воркерам забирать задачи для выполнения.

### Задача Taskiq

Задачи в Taskiq описываются с помощью декоратора `@broker.task`. Этот декоратор делает функцию доступной для выполнения в фоне.
Например, в вашем случае задача парсинга пользователей с GitHub выглядит так:

### Как Taskiq использует Redis?

В Taskiq Redis используется для двух ключевых функций:

1. **Очередь задач**: Redis служит как брокер сообщений, принимая задачи от FastAPI-приложения и передавая их воркерам для
   выполнения.

2. **Хранилище результатов**: Redis также может хранить результаты выполнения задач. После завершения задачи результат можно
   извлечь из Redis и использовать в приложении или передать клиенту через API.

### Шаги работы:

1. **FastAPI-приложение** получает HTTP-запрос.
2. **Taskiq** ставит задачу в очередь Redis.
3. **Воркер Taskiq** забирает задачу из Redis и выполняет её в фоне.
4. **Результат** сохраняется в Redis и может быть запрошен через API или извлечён воркером для дальнейшей обработки.

## Заключение

Taskiq — это современный и гибкий менеджер задач, который идеально подходит для асинхронных приложений на базе Python. Он
предлагает множество возможностей, таких как строгая типизация, гибкая интеграция с брокерами сообщений и удобное расширение
функциональности через замену компонентов. Благодаря интеграции с Redis, Taskiq становится мощным инструментом для обработки
фоновых задач в распределённых системах.
